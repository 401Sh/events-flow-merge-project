# Our events backend - NestJS + TypeScript + Axios

## Цель проекта

Разработать бэкенд, который будет агрегировать и предоставлять данные о мероприятиях с двух независимых API: Leader-id и Timepad.

## Задачи

- [X] Получение списка мероприятий
- [ ] Фильтрация мероприятий по местоположению пользователя на основе IP
- [ ] Просмотр информации о мероприятии
- [ ] Вход по OAuth Timepad/Leader-ID
- [ ] Список посещенных пользователем мероприятий
- [ ] Список мероприятий на которые записался пользователь

## Технологии

- **TypeScript** - статическая типизация для повышения надежности кода.
- **Class-Validator** - валидация клиентских запросов.
- **NestJS** - обработка маршрутов.
- **@NestJS/Axios** - формирование запросов к API.

## Установка

1. Клонируйте репозиторий

```bash
git clone https://gitverse.ru/studentlabs/our_events_backend
```

2. Перейдите в директорию проекта

```bash
cd our_events_backend
```

3. Устновите зависимости

```bash
npm install
```

## Запуск

Для запуска проекта потребуется создать файл .env в корне каталога и настроить его. Пример конфигурации - example.env файл.
В данный момент проект не может работать без предоставления токена доступа к API timepad и client_id с secret_id от API leader-id.
- Получить токен доступа timepad можно ссылке: https://dev.timepad.ru/api/oauth/
- Получить client_id и secret_id от leader-id можно по ссылке: https://leader-id.ru/en/developers

```bash
npm run start
```

После запуска проект будет доступен по адресу {HOST}:{PORT}/api/v1, а Swagger по адресу {HOST}:{PORT}/api/v1/docs

## Структура проекта

```
src/
│
│── auth/               # Модули аунтентификации и авторизации
│   ├── client-auth/    # Модуль получения токенов доступа к API
│   ├── interfaces/
│   ├── oauth/          # Модуль пользовательской аутентификации
│
│── configs/
│── constants/
│
│── dictionaries/       # Модуль словарей
│   ├── dto/
│   ├── interfaces/
│   ├── repositories/   # Абстракции и реализации запросов dictionaries со сторонних API
│
│── events/             # Модуль мероприятий
│   ├── api-utils/      # Мапперы для приведения events к одному виду
│   ├── dto/
│   ├── enums/
│   ├── interfaces/
│   ├── repositories/   # Абстракции и реализации запросов events со сторонних API
│
│── geo/                # Модуль городов и местоположения
│
│── users/              # Модуль пользователей
.env
tsconfig.json
package.json
```

## Используемые роуты

### Модуль dictionaries

- **GET    /dictionaries/themes/:source**            - Получение списка категорий/тем от источника

### Модуль events

- **GET    /events**                              - Получение общего списка событий от двух источников
- **GET    /events/:source**                      - Получение списка событий от источника
- **GET    /events/:source/:eventId**             - Получение данных о событии от источника (в данный момент работает только для timepad)